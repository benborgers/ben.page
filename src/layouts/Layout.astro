---
interface Props {
  title?: string;
}

// @ts-ignore
import { execSync } from "child_process";

const gitCommitSha = execSync('git log -n 1 --format="%h"').toString().trim();

const { title } = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="https://emojicdn.elk.sh/🐙" />

    <meta name="viewport" content="width=device-width" />
    <title>{title ? title + " - " : ""}Ben Borgers</title>

    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@600"
      rel="stylesheet"
    />
  </head>
  <body class="bg-gray-100 text-gray-700 antialiased">
    <div
      class="max-w-xl mx-auto px-4 pt-20 pb-8 relative min-h-screen grid grid-rows-[max-content,1fr,max-content]"
    >
      <div class="flex items-center justify-between">
        <a
          href="/"
          class="block w-max font-serif text-gray-800 text-lg font-medium -mb-1"
        >
          Ben Borgers
        </a>

        <div class="flex items-center gap-x-1.5">
          <div class="block relative group">
            <a
              href="mailto:benborgers@hey.com"
              target="_blank"
              class="relative z-10"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 256 256"
                class="w-5 fill-gray-800"
              >
                <rect width="256" height="256" fill="none"></rect>
                <path
                  d="M228.44,89.34l-96-64a8,8,0,0,0-8.88,0l-96,64A8,8,0,0,0,24,96V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V96A8,8,0,0,0,228.44,89.34ZM96.72,152,40,192V111.53Zm16.37,8h29.82l56.63,40H56.46Zm46.19-8L216,111.53V192Z"
                ></path>
              </svg>
            </a>

            <div
              class="absolute top-0 -right-1 hidden group-hover:block pt-[1.3rem]"
            >
              <div class="bg-gray-800 px-2 py-0.5 rounded-lg">
                <p class="text-white text-sm font-medium">benborgers@hey.com</p>
              </div>
            </div>
          </div>
          <a href="https://twitter.com/benborgers" target="_blank">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 256 256"
              class="w-5 fill-sky-500"
            >
              <rect width="256" height="256" fill="none"></rect>
              <path
                d="M245.66,77.66l-29.9,29.9C209.72,177.58,150.67,232,80,232c-14.52,0-26.49-2.3-35.58-6.84-7.33-3.67-10.33-7.6-11.08-8.72a8,8,0,0,1,3.85-11.93c.26-.1,24.24-9.31,39.47-26.84a110.93,110.93,0,0,1-21.88-24.2c-12.4-18.41-26.28-50.39-22-98.18a8,8,0,0,1,13.65-4.92c.35.35,33.28,33.1,73.54,43.72V88a47.87,47.87,0,0,1,14.36-34.3A46.87,46.87,0,0,1,168.1,40a48.66,48.66,0,0,1,41.47,24H240a8,8,0,0,1,5.66,13.66Z"
              ></path>
            </svg>
          </a>
        </div>
      </div>

      <slot />

      <footer
        class="mt-24 border-t-2 border-gray-200 pt-6 flex justify-between items-center"
      >
        <p class="text-sm text-gray-400">
          <span class="font-handwriting text-xl mr-1">ben.page</span> — last
          updated
          <a
            href={`https://github.com/benborgers/ben.page/commit/${gitCommitSha}`}
            target="_blank"
            class="underline"
          >
            <time id="last-updated" datetime={Date.now().toString()}>
              {
                new Date().toLocaleString("en-US", {
                  timeZone: "America/New_York",
                  month: "short",
                  day: "numeric",
                })
              }
            </time>
          </a>

          <p class="text-sm text-gray-400">
            email: <a
              href="mailto:benborgers@hey.com"
              target="_blank"
              class="underline"
            >
              benborgers@hey.com
            </a>
          </p>
        </p>

        <script>
          const time = document.querySelector("#last-updated")!;
          const date = new Date(parseInt(time.getAttribute("datetime")!));

          const diff = Date.now() - date.getTime();
          const diffInMinutes = Math.floor(diff / 1000 / 60);
          const diffInHours = Math.floor(diff / 1000 / 60 / 60);
          const diffInDays = Math.floor(diff / 1000 / 60 / 60 / 24);

          const pluralize = (num: number, word: string) =>
            `${num} ${word}${num === 1 ? "" : "s"}`;

          if (diffInMinutes < 1) {
            time.textContent = "just now";
          } else if (diffInMinutes < 60) {
            time.textContent = pluralize(diffInMinutes, "minute") + " ago";
          } else if (diffInHours < 24) {
            time.textContent = pluralize(diffInHours, "hour") + " ago";
          } else {
            time.textContent = pluralize(diffInDays, "day") + " ago";
          }
        </script>
      </footer>
    </div>
  </body>
</html>
